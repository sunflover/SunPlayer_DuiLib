<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>XiMoL NSIS Contribution</title>
<meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />
<style type="text/css">
/*<![CDATA[*/

body
        {
        padding: 10px;
        background-color: #F0F0F0;
        font-size: 13px;
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-weight: normal;
        text-align: left;
        }

p, li
        {
        font-size: 13px;
        }

table
        {
        margin: auto;
        background-color: #FFFFFF;
        }

.maintable
        {
        border: 2px solid #376EAB;
        }

.parameter
        {
        font-weight: bold;
        color: #6586AC;
        }

h1
        {
        font-size: 20px;
        color: #7A7272;
        font-weight: normal;
        }

h2
        {
        font-size: 17px;
        font-weight: bold;
        color: #303030;
        }

h3
        {
        font-size: 14px;
        font-weight: bold;
        color: #2B5885;
        }

pre     {
        font-size: 13px;
        }

div
        {
        margin: 20px;
        }

.footer
        {
        font-size: 10px;
        text-align: right;
        color: #909090;
        margin: 5px;
        }

a:link, a:visited, a:active
        {
        color: #294F75;
        text-decoration: none;
        }

a:hover
        {
        color: #182634;
        text-decoration: underline;
        }

.trigger {
        cursor: pointer;
        cursor: hand;
}

.toggle
        {
        display: none;
        }

.options
	{
	text-align: center;
	cursor: pointer;
        cursor: hand;
        color: #294F75;
	}

/*]]>*/
</style>

<script type="text/javascript">
//<![CDATA[

   var image_open = new Image();
   image_open.src = "images/open.gif";
   var image_closed = new Image();
   image_closed.src = "images/closed.gif";

   function toggle(image, section) {

      if(document.all) {
        if(document.all[section].style.display == "block") {
           document.all[section].style.display = "none";
           document.all[image].src = image_closed.src;
        }
        else
        {
           document.all[section].style.display = "block";
           document.all[image].src = image_open.src;
        }
      }
      else
      {
      if(document.getElementById(section).style.display == "block") {
         document.getElementById(section).style.display = "none";
         document.getElementById(image).src = image_closed.src;
         }
      else
         {
         document.getElementById(section).style.display = "block";
         document.getElementById(image).src = image_open.src;
         }
      }

   }

   function expandall() {

     var divNodeList = document.getElementsByTagName('div');
     for (i = 0; i < divNodeList.length; i++) {
        if(divNodeList[i].id) {
           divNodeList[i].style.display = "block";
           document.getElementById('trigger_' + divNodeList[i].id.substr(7)).src = "images/open.gif";
        }
     }

   }

   function collapseall() {

     var divNodeList = document.getElementsByTagName('div');
     for (i = 0; i < divNodeList.length; i++) {
        if(divNodeList[i].id) {
           divNodeList[i].style.display = "none";
           document.getElementById('trigger_' + divNodeList[i].id.substr(7)).src = "images/closed.gif";
        }
     }

   }

//]]>
</script>
</head>
<body>
<table width="750" class="maintable" cellspacing="0" cellpadding="0" align="center">
<tr><td><table width="100%" cellspacing="0" cellpadding="0">
<tr><td><img src="images/header.gif" height="80" alt="" /></td><td align="right"><img src="images/header-right.gif" height="80" alt="" /></td></tr>
</table>
</td></tr>
<tr>
      <td>
<p class="options"><a onclick="expandall()">[Expand all]</a>&nbsp;
&nbsp;<a onclick="collapseall()">[Collapse all]</a></p>
<div>
        <div>
          <h1>Introduction</h1>
          <div>
          <p>XiMoL allows to read XML file with the XML structure.</p>
          </div>
          <h1>Open a File</h1>
        <div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_ReadXmlFile" src="images/closed.gif" onclick="toggle('trigger_ReadXmlFile', 'toggle_ReadXmlFile');" />XiMoL_ReadXmlFile</h3>
              <div class="toggle" id="toggle_ReadXmlFile">
              <p>Open a XML file, read the data, and return a handler to the data structure. All data are in memory at this time.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Output) An abstract pointer to fetch the data in memory.</li>
                <li>FILENAME : (Input) The filename.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_ReadXmlFile HANDLER FILENAME</PRE></p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_ReadXmlFile $XMLHandler "test1.xml"</PRE></p>
              </div>
              <!-- ================================================== -->
        </div>

          <h1>XML Element</h1>
        <div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetTag" src="images/closed.gif" onclick="toggle('trigger_GetTag', 'toggle_GetTag');" />XiMoL_GetTag</h3>
              <div class="toggle" id="toggle_GetTag">
              <p>Get the tag of the element pointed by the handler.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Inupt) An abstract pointer to fetch the data in memory.</li>
                <li>TAG : (Ouput) The tag.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetTag HANDLER TAG</PRE>
              </p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetTag $XMLHandler $0</PRE>
              </p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetContent" src="images/closed.gif" onclick="toggle('trigger_GetContent', 'toggle_GetContent');" />XiMoL_GetContent</h3>
              <div class="toggle" id="toggle_GetContent">
              <p>Get the content of the element pointed by the handler.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Inupt) An abstract pointer to fetch the data in memory.</li>
                <li>CONTENT : (Ouput) The content.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetTag HANDLER CONTENT</PRE>
              </p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetContent $XMLHandler $0</PRE>
              </p>
              </div>
              <!-- ================================================== -->
        </div>

          <h1>XML Attributes</h1>
        <div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetNumberOfAttributes" src="images/closed.gif" onclick="toggle('trigger_GetNumberOfAttributes', 'toggle_GetNumberOfAttributes');" />XiMoL_GetNumberOfAttributes</h3>
              <div class="toggle" id="toggle_GetNumberOfAttributes">
              <p>Return the number of attribute of the element pointed by the handler.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Input) An abstract pointer to fetch the data in memory.</li>
                <li>NB : (Ouput) The number of attribute of the data.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetNumberOfAttributes HANDLER NB</PRE>
              </p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetNumberOfAttributes $XMLHandler $0</PRE>
              </p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetAttributeName" src="images/closed.gif" onclick="toggle('trigger_GetAttributeName', 'toggle_GetAttributeName');" />
              XiMoL_GetAttributeName</h3>
              <div class="toggle" id="toggle_GetAttributeName">
              <p>Return the name of attribute number nb of the element pointed by the handler.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Input) An abstract pointer to fetch the data in memory.</li>
                <li>NB : (Input) The number of attribute of the data.</li>
                <li>NAME : (Ouput) The name of the attribute number NB of the data.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetAttributeName HANDLER NB NAME</PRE>
              </p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetAttributeName $XMLHandler 0 $0</PRE>
              </p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetAttributeValue" src="images/closed.gif" onclick="toggle('trigger_GetAttributeValue', 'toggle_GetAttributeValue');" />
              XiMoL_GetAttributeValue</h3>
              <div class="toggle" id="toggle_GetAttributeValue">
              <p>Return the value of the attribute named ATTRIBUTE_NAME of the element pointed by the handler. If the attribute name does not exist then an empty string is return.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Input) An abstract pointer to fetch the data in memory.</li>
                <li>ATTRIBUTE_NAME : (Input) The name of the attribute.</li>
                <li>VALUE : (Ouput) The value of the attribute. The value is empty if the attribute does not exist.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetAttributeValue HANDLER ATTRIBUTE_NAME VALUE</PRE>
              </p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetAttributeValue $XMLHandler "size" $0</PRE>
              </p>
              </div>
              <!-- ================================================== -->
        </div>

          <h1>DOM Navigation</h1>
        <div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetNumberOfElements" src="images/closed.gif" onclick="toggle('trigger_GetNumberOfElements', 'toggle_GetNumberOfElements');" />
              XiMoL_GetNumberOfElements </h3>
              <div class="toggle" id="toggle_GetNumberOfElements">
              <p>Get the number of elements of the data pointed by the handler.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Input) An abstract pointer to fetch the data in memory.</li>
                <li>NB : (Output) Number of element.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetNumberOfElements HANDLER NB</PRE></p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetNumberOfElements $XMLHandler $0</PRE></p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetElementName" src="images/closed.gif" onclick="toggle('trigger_GetElementName', 'toggle_GetElementName');" />
              XiMoL_GetElementName </h3>
              <div class="toggle" id="toggle_GetElementName">
              <p>Get the name of the element nb of the data pointed by the handler.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Input) An abstract pointer to fetch the data in memory.</li>
                <li>NB : (Input) Number of the element.</li>
                <li>NAME : (Ouput) Name of the element. An empty string is return if the element does not exist</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetElementName HANDLER NB NAME</PRE></p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetElementName $XMLHandler 1 $0</PRE></p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetElement" src="images/closed.gif" onclick="toggle('trigger_GetElement', 'toggle_GetElement');" />
              XiMoL_GetElement </h3>
              <div class="toggle" id="toggle_GetElement">
              <p>Get a new handler to a sub element.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Input) An abstract pointer to fetch the data in memory.</li>
                <li>NB : (Input) Number of the element.</li>
                <li>NEW_HANDLER : (Ouput) a new handler pointed to the element number NB. If the element does not exist, the handler is not valide and an error will occur at the next call of XiMoL</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetElement HANDLER NB NEW_HANDLER</PRE></p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetElement $XMLHandler 1 $XMLHandler2</PRE></p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetNextElement" src="images/closed.gif" onclick="toggle('trigger_GetNextElement', 'toggle_GetNextElement');" />
              XiMoL_GetNextElement</h3>
              <div class="toggle" id="toggle_GetNextElement">
              <p>Move the element pointed by the handler to the next element and got to the label GOTO_IF_SUCCES if the element exist.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Input) An abstract pointer to fetch the data in memory.</li>
                <li>GOTO_IF_SUCCES : (Input) Label to goto if the next element exist.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetNextElement HANDLER GOTO_IF_SUCCES</PRE></p>
              <p><strong>Example:</strong>
              <PRE>
#
# print all sub element tag
#
; Open the file
!insertmacro XiMoL_ReadXmlFile $XMLHandlerRoot "test.xml"
; Get the number of elements
!insertmacro XiMoL_GetNumberOfElements $XMLHandlerRoot $0
; if the number is 0 go to end
StrCmp $0 "0" PrintElementTagEnd
; Get the first element
!insertmacro XiMoL_GetElement $XMLHandlerRoot 0 $XMLHandler
PrintElementTag:
; Get the tag
!insertmacro XiMoL_GetTag $XMLHandler $0
MessageBox MB_OK "tag=$0"
; Goto the next element
!insertmacro XiMoL_GetNextElement $XMLHandler PrintElementTag
PrintElementTagEnd:
              </PRE></p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetElementFromPath" src="images/closed.gif" onclick="toggle('trigger_GetElementFromPath', 'toggle_GetElementFromPath');" />
              XiMoL_GetElementFromPath</h3>
              <div class="toggle" id="toggle_GetElementFromPath">
              <p>Get a new handler define by a path. An error occur when the element does not exist.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Input) An abstract pointer to fetch the data in memory.</li>
                <li>PATH : (Input) A path to the new element. The path "" define the first sub element of the data. The path "Tag/" will point to the first sub element named "Tag". You could have a long path like "Tag1/Tag2/Tag3/" and then the New handler will have the tag "Tag3". The path must be finish by a "/".</li>
                <li>NEW_HANDLER : (Ouput) A handler to the new element.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetElementFromPath HANDLER PATH NEW_HANDLER</PRE></p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetElementFromPath $XMLHandler "Data/x/" $handlerToX</PRE></p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_IfPathExists" src="images/closed.gif" onclick="toggle('trigger_IfPathExists', 'toggle_IfPathExists');" />
              XiMoL_IfPathExists</h3>
              <div class="toggle" id="toggle_IfPathExists">
              <p>test a Path and goto the label.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>HANDLER : (Input) An abstract pointer to fetch the data in memory.</li>
                <li>PATH : (Input) A path to the new element. See XiMoL_GetElementFromPath.</li>
                <li>GOTO_IF_PATH_EXISTS : (Input) Label to goto if path exist.</li>
                <li>GOTO_IF_NOT : (Input) Label to goto if path does not exist.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_IfPathExists HANDLER PATH GOTO_IF_PATH_EXISTS GOTO_IF_NOT</PRE></p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_IfPathExists $XMLHandler "Data/x/" have_x does_not_have_x</PRE></p>
              </div>
              <!-- ================================================== -->
        </div>




<h1>Error handling</h1>
        <div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetErrorMessage" src="images/closed.gif" onclick="toggle('trigger_GetErrorMessage', 'toggle_GetErrorMessage');" />
              XiMoL_GetErrorMessage</h3>
              <div class="toggle" id="toggle_GetErrorMessage">
              <p>return the last error message.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>VAR : (Output) A variable to store the message.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetErrorMessage VAR</PRE></p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetErrorMessage $0</PRE></p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_GetLastCall" src="images/closed.gif" onclick="toggle('trigger_GetLastCall', 'toggle_GetLastCall');" />
              XiMoL_GetLastCall</h3>
              <div class="toggle" id="toggle_GetLastCall">
              <p>return the last call to XiMoL.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>VAR : (Output) A variable to store the instruction.</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_GetLastCall VAR</PRE></p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_GetLastCall $0</PRE></p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_SetErrorGotoLabel" src="images/closed.gif" onclick="toggle('trigger_SetErrorGotoLabel', 'toggle_SetErrorGotoLabel');" />
              XiMoL_SetErrorGotoLabel</h3>
              <div class="toggle" id="toggle_SetErrorGotoLabel">
              <p>Define the label to goto if an error occur during a XiMoL Call.</p>
              <p><strong>Parameters:</strong>
              <ol>
                <li>LABEL : (Input) Define the error handling label. During the next XiMoL Call if an error occur, the execution flow will go to the LABEL</li>
              </ol>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_SetErrorGotoLabel LABEL</PRE></p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_SetErrorGotoLabel xml_error_handler</PRE></p>
              </div>
              <!-- ================================================== -->
              <h3><img class="trigger" alt="Open/Close section" id="trigger_ResetErrorGotoLabel" src="images/closed.gif" onclick="toggle('trigger_ResetErrorGotoLabel', 'toggle_ResetErrorGotoLabel');" />
              XiMoL_ResetErrorGotoLabel</h3>
              <div class="toggle" id="toggle_ResetErrorGotoLabel">
              <p>Reset the error goto Label.</p>
              <p><strong>Parameters:</strong>
              </p>
              <p><strong>Usage:</strong>
              <PRE>!insertmacro XiMoL_ResetErrorGotoLabel</PRE></p>
              <p><strong>Example:</strong>
              <PRE>!insertmacro XiMoL_ResetErrorGotoLabel</PRE></p>
              </div>
              <!-- ================================================== -->
        </div>
          <h1>Source code</h1>
          <div>
          <h3>NSIS plug-in (C++)</h3>
          <div>
          <p>The source of the NSIS plug-in can be found
            in the XiMoL project at sourceforge.net.
<a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=63115&amp;type=1" width="88" height="31" border="0" alt="SourceForge.net Logo"></a>
If you have any questions about XiMoL, you could write to <a href="mailto:tournois@users.sourceforge.net">tournois@users.sourceforge.net</a>.
</p>
          </div>
          </div>
          <h1>Version history</h1>
          <div>
          <ul>
            <li>1.0 beta 1
              <ul>
                <li>First Version.</li>
              </ul>
            </li>
          </ul>
          </div>
          <h1>Credits</h1>
          <div>
          <p>Written by Florent Tournois</p>
          </div>
          <h1>License GPL</h1>
          <div>
          <pre>
#=============================================================================#
#                                                                             #
#    "XiMoL NSIS contrib"                                                     #
#    Copyright (C) 2005 Florent Tournois                                      #
#                                                                             #
# This program is free software; you can redistribute it and/or               #
# modify it under the terms of the GNU General Public License                 #
# as published by the Free Software Foundation; either version 2              #
# of the License, or (at your option) any later version.                      #
#                                                                             #
# This program is distributed in the hope that it will be useful,             #
# but WITHOUT ANY WARRANTY; without even the implied warranty of              #
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the               #
# GNU General Public License for more details.                                #
#                                                                             #
# You should have received a copy of the GNU General Public License           #
# along with this program; if not, write to the Free Software                 #
# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,                  #
# MA  02110-1301, USA.                                                        #
#                                                                             #
#=============================================================================#
</pre>
</div>
        </div>
      </td>
</tr>
</table>
</body>
</html>
